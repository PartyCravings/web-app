imports:
    - { resource: parameters.yml }
    - { resource: security.yml }
    - { resource: services.yml }

# Put parameters here that don't need to change on each machine where the app is deployed
# https://symfony.com/doc/current/best_practices/configuration.html#application-related-configuration
parameters:
    locale: en
    app_locales: [en, de, zh]

framework:
    esi: { enabled: true }
    translator: { fallbacks: ['%locale%'] }
    secret: '%secret%'
    router:
        resource: '%kernel.project_dir%/app/config/routing.yml'
        strict_requirements: ~
    form: ~
    csrf_protection: { enabled: true }
    validation: { enable_annotations: true }
    #serializer: { enable_annotations: true }
    templating:
        engines: ['twig']
    default_locale: '%locale%'
    trusted_hosts: ~
    session:
        # https://symfony.com/doc/current/reference/configuration/framework.html#handler-id
        handler_id: session.handler.native_file
        save_path: '%kernel.project_dir%/var/sessions/%kernel.environment%'
    fragments: { path: /_fragment }
    http_method_override: true
    assets:
        json_manifest_path: '%kernel.project_dir%/web/build/manifest.json'

    cache:
        # this value is used as part of the "namespace" generated for the cache item keys
        # to avoid collisions when multiple apps share the same cache backend (e.g. a Redis server)
        # See https://symfony.com/doc/current/reference/configuration/framework.html#prefix-seed
        prefix_seed: symfony-cravings

    # The 'ide' option turns all of the file paths in an exception page
    # into clickable links that open the given file using your favorite IDE.
    # When 'ide' is set to null the file is opened in your web browser.
    # See https://symfony.com/doc/current/reference/configuration/framework.html#ide
    ide: ~

    php_errors:
        log: true

# Twig Configuration
twig:
    debug: '%kernel.debug%'
    strict_variables: '%kernel.debug%'

# Doctrine Configuration
doctrine:
    dbal:
        driver: pdo_mysql
        host: '%database_host%'
        port: '%database_port%'
        dbname: '%database_name%'
        user: '%database_user%'
        password: '%database_password%'
        charset: UTF8
        #default_table_options:
        #    charset: utf8
        #    collate: utf8_unicode_ci
        # if using pdo_sqlite as your database driver:
        #   1. add the path in parameters.yml
        #     e.g. database_path: "%kernel.root_dir%/../var/data/data.sqlite"
        #   2. Uncomment database_path in parameters.yml.dist
        #   3. Uncomment next line:
        #path: '%database_path%'

    orm:
        auto_generate_proxy_classes: '%kernel.debug%'
        naming_strategy: doctrine.orm.naming_strategy.underscore
        auto_mapping: true
        #Stof ORM Mappings
        mappings:
                    gedmo_loggable:
                        type: annotation
                        prefix: Gedmo\Loggable\Entity
                        dir: "%kernel.root_dir%/../vendor/gedmo/doctrine-extensions/lib/Gedmo/Loggable/Entity"
                        is_bundle: false
                    gedmo_tree:
                        type: annotation
                        prefix: Gedmo\Tree\Entity
                        dir: "%kernel.root_dir%/../vendor/gedmo/doctrine-extensions/lib/Gedmo/Tree/Entity"
                        is_bundle: false
        filters:
                    softdeleteable:
                        class: Gedmo\SoftDeleteable\Filter\SoftDeleteableFilter
                        enabled: true

# Swiftmailer Configuration
swiftmailer:
    transport: '%mailer_transport%'
    host: '%mailer_host%'
    username: '%mailer_user%'
    password: '%mailer_password%'
    spool: { type: memory }

#FOSUserBundle Configuration
fos_user:
    db_driver: orm # other valid values are 'mongodb' and 'couchdb'
    firewall_name: main
    user_class: AppBundle\Entity\Accounts
    from_email:
        address: "%mailer_user%"
        sender_name: "%mailer_user%"

#Doctrine Migrations Configuration
doctrine_migrations:
    dir_name: "%kernel.root_dir%/../src/AppBundle/Doctrine/Migrations"
    namespace: AppBundle\Doctrine\Migrations
    table_name: migration_versions
    name: Application Migrations

#HWIOAuth Bundle Configuration
hwi_oauth:
    #this is my custom user provider, created from FOSUBUserProvider - will manage the 
    #automatic user registration on your site, with data from the provider (facebook. google, etc.)
    #and also, the connecting part (get the token and the user_id)
    connect:
        account_connector: AppBundle\Security\FOSUBUserProvider
    # name of the firewall in which this bundle is active, this setting MUST be set
    firewall_names: [main]
    fosub:
        username_iterations: 30
        properties:
            # these properties will be used/redefined later in the custom FOSUBUserProvider service.
            google: google_id
    #Peer Certificate Verification
    http_client:
        verify_peer: true

    resource_owners:
        google:
            type:                google
            client_id:           "%google_app_id%"
            client_secret:       "%google_app_secret%"
            scope:               "https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile"

#JMS Translator Bundle Configuration
jms_translation:
    configs:
        app:
            dirs: ["%kernel.root_dir%", "%kernel.root_dir%/../src"]
            output_dir: "%kernel.root_dir%/Resources/translations"
            excluded_names: ["*TestCase.php", "*Test.php"]
            excluded_dirs: [cache, data, logs]
            extractors: [jms_i18n_routing]

#JMS i8n Routing Bundle Configuration
jms_i18n_routing:
    default_locale: '%locale%'
    locales: '%app_locales%'
    strategy: custom

#Stof Doctrine extensions Configuration
stof_doctrine_extensions:
    default_locale: '%locale%'
    orm:
        default:
            tree:           true
            timestampable:  true
            blameable:      true
            sluggable:      true
            loggable:       true
            softdeleteable: true

#FOSOAUth 2 Server Bundle Configurations
fos_oauth_server:
    db_driver: orm       # Drivers available: orm, mongodb, or propel
    client_class:        AppBundle\Entity\Client
    access_token_class:  AppBundle\Entity\AccessToken
    refresh_token_class: AppBundle\Entity\RefreshToken
    auth_code_class:     AppBundle\Entity\AuthCode
    service:
        user_provider: AppBundle\Security\FOSUBUserProvider
        options:
            supported_scopes: scope1 scope2

#KnpGaufrette Bundle Configurations
knp_gaufrette:
    adapters:
        gallery:
            local:
                directory:  '%kernel.project_dir%/web/uploads'
                create:     true

        gallery_database:
            doctrine_dbal:
                connection_name: default
                table: media
                columns:
                    key: id
                    content: name
                    mtime: dateAdd
                    checksum: filesize

        gallery_apc:
            apc:
                prefix: APC_party_gallery.
                ttl: 0
        gallery_cache:
            cache:
                source: gallery
                cache: gallery_database
                ttl: 7200
    filesystems:
        gallery:
            adapter: gallery_cache
    stream_wrapper: ~

#Oneup Uploader Bundle Configurations
oneup_uploader:
    orphanage:
        maxage: 86400
        directory: ~

    mappings:
        gallery:
            frontend: blueimp
            storage:
                type: gaufrette
                filesystem: gaufrette.gallery_filesystem
                sync_buffer_size: 10M
                stream_wrapper: gaufrette://gallery/

            allowed_mimetypes:     []
            disallowed_mimetypes:  []
            error_handler:        oneup_uploader.error_handler.noop
            max_size:             9223372036854775807
            use_orphanage:        true
            enable_progress:      true
            enable_cancelation:   true
            namer:                oneup_uploader.namer.uniqid

    chunks:
        maxage: 86400
        storage:
            type: gaufrette
            filesystem: gaufrette.gallery_filesystem
            prefix: chunks
            stream_wrapper: gaufrette://gallery/
            sync_buffer_size:   10M

        load_distribution:    true

#Gravatar Bundle Configurations
ornicar_gravatar:
    rating: g
    size: 80
    default: mm

#Noxlogic Rate Limit Bundle Configuration
noxlogic_rate_limit:
    enabled: false

#rsGaufretteBrowserBundle Configuration
rs_gaufrette_browser:
    file_pattern:    /\.(jpg|gif|jpeg|png)$/    # a valid regular expression to filter for file-extensions
    filesystem:      gaufrette.gallery_filesystem           # the gaufrette filesystem alias to use
    file_class:      AppBundle\Entity\Files